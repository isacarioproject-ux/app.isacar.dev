ğŸ” DEBUG - Google NÃ£o Conecta na Segunda Tentativa

ğŸ“Š LOGS DETALHADOS ADICIONADOS

Agora o console vai mostrar EXATAMENTE o que estÃ¡ acontecendo.

ğŸ§ª TESTE PASSO A PASSO:

1. ABRIR CONSOLE
   F12 â†’ Console â†’ Limpar (Ã­cone ğŸš«)

2. RECARREGAR PÃGINA
   Ctrl + Shift + R

3. IR EM SETTINGS â†’ INTEGRATIONS

4. CLICAR "CONECTAR GOOGLE"

5. AUTORIZAR NO GOOGLE

6. VOLTAR PARA APP

7. OLHAR NO CONSOLE

ğŸ“‹ O QUE VOCÃŠ DEVE VER NO CONSOLE:

FLUXO NORMAL (ESPERADO):
```
ğŸ”” Auth state changed: SIGNED_IN { hasSession: true, hasProviderToken: true, provider: "google" }
âœ… OAuth detectado, salvando integraÃ§Ã£o...
ğŸ“ saveGoogleIntegration chamada { hasToken: true, tokenLength: 253, userId: "xxx" }
ğŸ“§ Buscando info do Google...
âœ… Info do Google obtida: seu-email@gmail.com
ğŸ” Testando token no Drive API...
âœ… Token vÃ¡lido!
ğŸ’¾ Salvando na tabela google_integrations...
ğŸ“Š Dados a inserir: { user_id: "xxx", email: "seu-email@gmail.com", scopes: 6 }
âœ… Google integration saved: seu-email@gmail.com
âœ… IntegraÃ§Ã£o salva, aguardando 1s...
âœ… Verificando conexÃ£o...
âœ… Tudo pronto!
```

ğŸš¨ CENÃRIOS DE ERRO:

CENÃRIO 1: SEM provider_token
```
ğŸ”” Auth state changed: SIGNED_IN { hasSession: true, hasProviderToken: false, provider: "google" }
âš ï¸ SIGNED_IN mas SEM provider_token - OAuth pode nÃ£o ter funcionado
```
â†’ PROBLEMA: Supabase nÃ£o estÃ¡ retornando provider_token
â†’ SOLUÃ‡ÃƒO: Verificar configuraÃ§Ã£o OAuth no Supabase Dashboard

CENÃRIO 2: Token invÃ¡lido
```
âœ… OAuth detectado, salvando integraÃ§Ã£o...
ğŸ“ saveGoogleIntegration chamada
ğŸ“§ Buscando info do Google...
âœ… Info do Google obtida
ğŸ” Testando token no Drive API...
âŒ Erro ao salvar integraÃ§Ã£o Google: Error: Token invÃ¡lido: 401 - Unauthorized
```
â†’ PROBLEMA: Token expirou ou sem permissÃµes
â†’ SOLUÃ‡ÃƒO: Reconectar e aprovar TODAS as permissÃµes

CENÃRIO 3: Erro ao salvar no banco
```
âœ… Token vÃ¡lido!
ğŸ’¾ Salvando na tabela google_integrations...
âŒ Erro do Supabase: { code: "42501", message: "permission denied" }
```
â†’ PROBLEMA: RLS bloqueando insert
â†’ SOLUÃ‡ÃƒO: Verificar polÃ­ticas RLS da tabela

CENÃRIO 4: Listener nÃ£o dispara
```
(Nenhum log aparece)
```
â†’ PROBLEMA: Listener nÃ£o estÃ¡ registrado
â†’ SOLUÃ‡ÃƒO: Recarregar pÃ¡gina completamente

ğŸ“ O QUE FAZER:

1. Tente conectar novamente
2. Veja EXATAMENTE o que aparece no console
3. Copie TODOS os logs
4. Me envie

ğŸ“Š INFORMAÃ‡Ã•ES ÃšTEIS:

Se NÃƒO aparecer NADA no console:
â†’ Listener nÃ£o estÃ¡ funcionando
â†’ onAuthStateChange nÃ£o dispara

Se aparecer "hasProviderToken: false":
â†’ Supabase OAuth mal configurado
â†’ Verificar redirect URLs

Se aparecer erro 401/403:
â†’ Problema com permissÃµes Google
â†’ Reconectar e aprovar tudo

Se aparecer erro do Supabase:
â†’ Problema com RLS ou estrutura da tabela
â†’ Verificar no Supabase Dashboard

ğŸ¯ APÃ“S COPIAR OS LOGS:

Me envie:
1. TODOS os logs do console (copy/paste)
2. Status que aparece (Conectado/Desconectado)
3. Se apareceu algum toast/mensagem

Com isso vou saber EXATAMENTE onde estÃ¡ o problema! ğŸš€
